@echo off
setlocal ENABLEDELAYEDEXPANSION
cmdwiz showcursor 0

set ANIM0="\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\01\00          \01          \00          \01          \00          \01          \00          \01          \00          \01          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n\00\01          \00          \01          \00          \01          \00          \01          \00          \01          \00          \n"
mode con COLS=80 lines=40
cls
gotoxy 0 0 %ANIM0%

set COLOR=E
set SCROLLTEXT="Trying out the \bVtransparent\%COLOR%V color effect...                                                                                       "
set DELAY=\W20
set YP=19

set SCROLLPOS=80
call util.bat strlen SCROLL_LEN %SCROLLTEXT%
set /a SCROLL_LEN=0-(SCROLL_LEN-80)
set CNT=0

:LOOP
set /a CNT+=1
set /a CCNT = %CNT% %% 20
if %CCNT% == 0 cmdwiz getch nowait
if %ERRORLEVEL% == 27 goto OUT

gotoxy.exe %SCROLLPOS% %YP% "\%COLOR%V%SCROLLTEXT:~1,-1%%DELAY%" %COLOR% U
set /a SCROLLPOS-=1
if %SCROLLPOS% == %SCROLL_LEN% set SCROLLPOS=81 & set /a YP = 5 + %RANDOM% %% 30

goto LOOP
:OUT

endlocal
cmdwiz showcursor 1
